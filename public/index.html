{% extends 'base.html' %}

{%block title%}index{%endblock%}

{% block content %}
<link rel="stylesheet" href="static/css/style.css">

  <div class="algorithms">
    <h3>Choose Algorithm:</h3>
    <div class="machine-learning">
        <div class="form-check">
            <input class="form-check-input" type="radio" name="selectedAlgorithm" id="algorithm1" value="ANN" checked>
            <label class="form-check-label" for="algorithm1">
                <h3>ANN</h3>
            </label>
            <img src="/public/static/images/info.svg" alt="Logo" class="info-logo", onclick="sendSignal('ANN')">
        </div>
        <div class="form-check">
            <input class="form-check-input" type="radio" name="selectedAlgorithm" id="algorithm2" value="LSTM">
            <label class="form-check-label" for="algorithm2">
              <h3>LSTM</h3>
            </label>
            <img src="/public/static/images/info.svg" alt="Logo" class="info-logo" onclick="sendSignal('LSTM')">
        </div>
    </div>
</div
>
<div class="dropdown">
  <h4>City</h4>
  <button class="btn btn-success dropdown-toggle"  type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" onclick="toggleDropdown()">
    <h5 id="selectedOption">Select City</h5>
  </button>
  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton" id="dropdownOptions">
    <a class="dropdown-item" href="#" onclick="selectOption('Paris')">Paris</a>
    <a class="dropdown-item" href="#" onclick="selectOption('Madrid')">Madrid</a>
    <a class="dropdown-item" href="#" onclick="selectOption('Stockholm')">Stockholm</a>
    <a class="dropdown-item" href="#" onclick="selectOption('Tokyo')">Tokyo</a>
  </div>
</div>


<form method="POST" action="/" id="cityForm">
    <input type="hidden" name="selectedCity" id="selectedCity" value="">
    <input type="hidden" name="selectedAlgorithm" id="selectedAlgorithm" value="">
    <button type="submit" class="btn go-button btn-success" id="go-button">GO!</button>
</form>

<script>
  function toggleDropdown() {
    document.getElementById("dropdownOptions").classList.toggle("show");
  }

  function selectOption(option) {
    document.getElementById("selectedOption").innerHTML = option;
    document.getElementById("selectedCity").value = option;
    document.getElementById("dropdownOptions").classList.remove("show");
  }

  document.addEventListener('DOMContentLoaded', function () {
        var algorithmRadios = document.querySelectorAll('input[name="selectedAlgorithm"]');
        algorithmRadios.forEach(function (radio) {
            radio.addEventListener('change', function () {
                // Update the selectedAlgorithm value when a radio button is selected
                document.getElementById("selectedAlgorithm").value = this.value;
            });
        });
    });



  window.onclick = function(event) {
    if (!event.target.matches('.dropdown-toggle')) {
      var dropdowns = document.getElementsByClassName("dropdown-menu");
      var i;
      for (i = 0; i < dropdowns.length; i++) {
        var openDropdown = dropdowns[i];
        if (openDropdown.classList.contains('show')) {
          openDropdown.classList.remove('show');
        }
      }
    }
  }

  function sendSignal(algorithm) {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "/signal", true);
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.send(JSON.stringify({
            algorithm: algorithm
        }));
    }

</script>
<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyCjTtpXLwjr4bwxIjmoRI4QCk0N0m7X3R8",
    authDomain: "weather-forecast-d2bfd.firebaseapp.com",
    projectId: "weather-forecast-d2bfd",
    storageBucket: "weather-forecast-d2bfd.appspot.com",
    messagingSenderId: "514220854568",
    appId: "1:514220854568:web:5e51f90b870c866148541d",
    measurementId: "G-78J42QMNC8"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
</script>



{% endblock %}